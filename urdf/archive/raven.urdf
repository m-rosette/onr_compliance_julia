<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from raven.xacro                    | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<!-- Raven vehicle (for now, using falcon mesh + cartoon camera head -->
<robot name="raven">
  <!-- 0.428 + 0.0781 -->
  <!-- Robot Chassis -->
  <!-- I tried to split this into two links, one with mass/inertia with
       an origin at the center of mass, and another with the visual/collision
       geometry and the origin at the IMU. However, this caused problems.
       I think the issue was:
       * Gazebo collapses rigidly-connected links, so not all named links
         will appear and be referencable in plugins
       * The dynamics plugin needs to apply to the link with the inertia
       * I want states to be published with base_link, via the oracle plugin.
       * disabling FixedJointLumping within a dummy -> COM -> base_link chain
         caused other problems ... (I think one was that a zero-mass link is
         numerically unstable.)
  -->
  <link name="raven/base_link">
    <!-- visual link for looking at bounding box used for moment of inertia calculations -->
    <!--
    <visual>
      <origin xyz="-0.1501 0 0.1425" rpy="0 0 0"/>
      <geometry>
        <box size="1.0914 0.85 0.5695"/>
      </geometry>
    </visual>
    -->
    <!-- TODO: This about center of bounding box, NOT the IMU / base_link origin -->
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <!-- mass approximate, at ~400 lbs.-->
      <mass value="182"/>
      <!-- Inertia calculated using bounding box from geometry.-->
      <inertia ixx="15.9" ixy="0" ixz="0" iyy="23.0" iyz="0" izz="29.0"/>
    </inertial>
    <visual>
      <origin rpy="-1.5707963267948966 0 1.5707963267948966" xyz="0.5630999999999999 -0.463 0.36350000000000005"/>
      <geometry>
        <mesh filename="C:/Users/marcu/OneDrive/Documents/GitHub/onr_compliance_julia/meshes/raven/RavenNoPH.obj" scale="0.001 0.001 0.001"/>
      </geometry>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <!-- TODO: this bounding box doesn't extend to the feet or the USBL beacon -->
        <box size="1.1 0.9 0.6"/>
      </geometry>
    </collision>
  </link>
  <!-- IMU; needed link b/c every other measurement is from the IMU. -->
  <link name="raven/imu"/>
  <joint name="imu_joint" type="fixed">
    <parent link="raven/base_link"/>
    <child link="raven/imu"/>
    <origin rpy="0 0 0" xyz="0.1501 0.0 -0.1425"/>
  </joint>
  <!-- Sensor head -->
  <!-- TODO: Paul provided sensor_head.dae with colors ... someday ask Jess for this?-->
  <!-- updated version from Jess, with lights. 27 Feb 2022.
       Still a WIP; offset not quite right + tilts down by default -->
  <link name="raven/sensor_head">
    <visual>
      <geometry>
        <mesh filename="C:/Users/marcu/OneDrive/Documents/GitHub/onr_compliance_julia/meshes/raven/PerceptionHead_v2.obj" scale="0.001 0.001 0.001"/>
      </geometry>
      <origin rpy="-1.5707963267948966 0 1.5707963267948966" xyz="0.11 -0.289 0.10"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.1 0.2 0.01"/>
      </geometry>
      <origin rpy="0 0 0" xyz="0.05 0 0"/>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0.05 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <!-- Tilt -->
  <link name="raven/tilt_axis">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="tilt_axis_joint" type="fixed">
    <parent link="raven/base_link"/>
    <child link="raven/tilt_axis"/>
    <origin xyz="0.4173 0.0025 -0.1972"/>
    <!-- From Jess, 27 Feb 2022. Perception head winds up mounted 1/8" starboard of true vehicle center. -->
  </joint>
  <joint name="tilt_joint" type="revolute">
    <!-- TODO: Fill joint limits in with real numbers -->
    <axis xyz="0 1 0"/>
    <limit effort="1000.0" lower="-1.5707963267948966" upper="1.5707963267948966" velocity="0.5"/>
    <!-- QUESTION: Why does making imu the parent cause all sorts of errors?-->
    <parent link="raven/tilt_axis"/>
    <child link="raven/sensor_head"/>
    <origin xyz="0 0 0"/>
  </joint>
  <!-- Adding a transmission is required for ros_control to recognize
       the joint and publish JointState messages -->
  <transmission name="tilt_transmission">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="tilt_joint">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <!-- It looks like this may be mandatory in the URDF. -->
    <actuator name="tilt_actuator"/>
  </transmission>
  <!-- Left stereo camera -->
  <link name="raven/stereo_left">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="stereo_left_joint" type="fixed">
    <parent link="raven/sensor_head"/>
    <child link="raven/stereo_left"/>
    <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0.0699 -0.0508 0.0365"/>
    <!-- From Jess, 27 Feb 2022 -->
  </joint>
  <!-- Right stereo camera -->
  <link name="raven/stereo_right">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="stereo_right_joint" type="fixed">
    <parent link="raven/sensor_head"/>
    <child link="raven/stereo_right"/>
    <!-- Frames here match up to what we want them to be in rviz, with
         Z as optical axis and X-Y formign the image plane, with the origin
         in top-left and X is width. However, the camera pose in Gazebo
         needed to be adjusted because it uses a different convention. -->
    <origin rpy="1.5707963267948966 0 1.5707963267948966" xyz="0.0699 0.0508 0.0365"/>
    <!-- From Jess, 27 Feb 2022 -->
    <!-- <origin xyz="0.23 0.06 0.02" rpy="${PI} ${PI/2} 0"/> -->
  </joint>
  <!-- Oculus -->
  <link name="raven/oculus">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="oculus_joint" type="fixed">
    <parent link="raven/sensor_head"/>
    <child link="raven/oculus"/>
    <origin xyz="0.0699 0.0 -0.0367"/>
    <!-- Tilt axis -> Oculus from Jess, 27 Feb 2022 -->
  </joint>
  <link name="raven/dvl">
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.01"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="dvl_joint" type="fixed">
    <parent link="raven/base_link"/>
    <child link="raven/dvl"/>
    <origin xyz="0.009000000000000008 0.0 0.25160000000000005"/>
    <!-- IMU -> DVL From Jess, 27 Feb 2022 -->
  </joint>
</robot>
